function handleResponse(e){const{token:t,text:o}=JSON.parse(e.responseText);if(t)if(localStorage.removeItem("isSubmitting"),localStorage.setItem("pinkettu",t),window.location.search){const e=decodeURIComponent(window.location.search);"pink"===e.slice(1,5)?window.location.assign(`/explore.html${e}`):window.location.assign("/profile.html")}else window.location.assign("/profile.html");else{const e=document.querySelector("p");e.textContent=o,e.style.color="#d9534f";const t=document.querySelector("button");toggleButtonSpinner(t,!1)}}function redirectToActivation(e){toggleButtonSpinner(e,!1),alert(request.responseText);const{id:t,message:o}=JSON.parse(request.responseText);if(t&&o)return void window.location.assign(`/activate.html?user=${t}`);const n=document.querySelector("#signup-main > div > p"),{color:i,fontWeight:s}=n.style;n.textContent="Network Error",n.style.color="#d9534f",n.style.fontWeight="900",setTimeout(()=>{n.textContent="Login In To Your Account",n.style.color=i,n.style.fontWeight=s},5e3)}const form=document.getElementsByTagName("form")[0];form.addEventListener("submit",e=>{if(e.preventDefault(),"true"===localStorage.isSubmitting)return;const t=e.target.children.finalSubmit;toggleButtonSpinner(t,!0);const o=`${API}/auth/login`,[n,i]=form,s=new XMLHttpRequest;s.onreadystatechange=function(){4===this.readyState&&(this.status>=400?redirectToActivation(t):handleResponse(this))},s.open("POST",o,!0),s.setRequestHeader("Content-type","application/json"),s.send(JSON.stringify({email:n.value.toLowerCase(),password:i.value.toLowerCase()}))}),document.addEventListener("DOMContentLoaded",e=>{localStorage.removeItem("isSubmitting")});