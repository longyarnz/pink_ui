function handleResponse(t){const{token:e,text:o,worker:n}=JSON.parse(t.responseText);if(e)if(localStorage.removeItem("isSubmitting"),localStorage.setItem("pinkettu",e),localStorage.setItem("pinkettu_user_status",n),window.location.search){const t=decodeURIComponent(window.location.search);"pink"===t.slice(1,5)?window.location.assign(`/explore.html${t}`):window.location.assign("/profile.html")}else window.location.assign("/profile.html");else{const t=document.querySelector("p");t.textContent=o,t.style.color="#d9534f";const e=document.querySelector("button");toggleButtonSpinner(e,!1)}}function redirectToActivation(t,e){toggleButtonSpinner(e,!1);const{id:o,message:n,email:i}=JSON.parse(t.responseText);if(o&&n&&i)return localStorage.setItem("activate_email",i),void window.location.assign(`/activate.html?user=${o}`);const s=document.querySelector("#signup-main > div > p"),{color:r,fontWeight:a}=s.style;s.textContent="Network Error",s.style.color="#d9534f",s.style.fontWeight="900",setTimeout(()=>{s.textContent="Login In To Your Account",s.style.color=r,s.style.fontWeight=a},5e3)}function loginUserIn(t){if(t.preventDefault(),"true"===localStorage.isSubmitting)return;const e=t.target.children.finalSubmit;toggleButtonSpinner(e,!0);const o=`${API}/auth/login`,[n,i]=form,s=new XMLHttpRequest;s.onreadystatechange=function(){4===this.readyState&&(this.status>=400?redirectToActivation(this,e):handleResponse(this))},s.open("POST",o,!0),s.setRequestHeader("Content-type","application/json"),s.send(JSON.stringify({email:n.value.toLowerCase(),password:i.value.toLowerCase()}))}document.addEventListener("DOMContentLoaded",t=>{localStorage.removeItem("isSubmitting");document.getElementsByTagName("form")[0].addEventListener("submit",loginUserIn)});