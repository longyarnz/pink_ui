function handleResponse(t){const{token:e,text:o}=JSON.parse(t.responseText);if(e)if(localStorage.removeItem("isSubmitting"),localStorage.setItem("pinkettu",e),window.location.search){const t=decodeURIComponent(window.location.search);"pink"===t.slice(1,5)?window.location.assign(`/explore.html${t}`):window.location.assign("/profile.html")}else window.location.assign("/profile.html");else{const t=document.querySelector("p");t.textContent=o,t.style.color="#d9534f";const e=document.querySelector("button");toggleButtonSpinner(e,!1)}}function redirectToActivation(t){toggleButtonSpinner(t,!1);const{id:e,message:o}=JSON.parse(request.responseText);if(e&&o)return void window.location.assign(`/activate.html?user=${e}`);const n=document.querySelector("#signup-main > div > p"),{color:i,fontWeight:s}=n.style;n.textContent="Network Error",n.style.color="#d9534f",n.style.fontWeight="900",setTimeout(()=>{n.textContent="Login In To Your Account",n.style.color=i,n.style.fontWeight=s},5e3)}const form=document.getElementsByTagName("form")[0];form.addEventListener("submit",t=>{if(t.preventDefault(),"true"===localStorage.isSubmitting)return;const e=t.target.children.finalSubmit;toggleButtonSpinner(e,!0);const o=`${API}/auth/login`,[n,i]=form,s=new XMLHttpRequest;s.onreadystatechange=function(){4===this.readyState&&(this.status>=400?redirectToActivation(e):handleResponse(this))},s.open("POST",o,!0),s.setRequestHeader("Content-type","application/json"),s.send(JSON.stringify({email:n.value.toLowerCase(),password:i.value.toLowerCase()}))}),document.addEventListener("DOMContentLoaded",t=>{localStorage.removeItem("isSubmitting")});