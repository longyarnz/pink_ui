function validatePassword(){const e=document.getElementById("pass"),t=document.getElementById("confirm");e.value!==t.value?t.setCustomValidity("Passwords Don't Match"):t.setCustomValidity("")}function handleSubmitResponse(e){const{id:t,message:o,token:n}=JSON.parse(e.responseText);t||o?window.location.assign(`/activate.html?user=${t}`):n&&(localStorage.pinkettu=n,window.location.assign("/profile.html"))}function submitForm(e){if(e.preventDefault(),"true"===localStorage.isSubmitting)return;const t=e.target.children.finalSubmit;toggleButtonSpinner(t,!0);const o=`${API}/auth/signup`,{email:n,username:a,phone:s,password:i,orientation:r,location:l,worker:u,image:c}=e.target.elements,d=c.files[0],m=d.name.split(".").pop(),g="JKHIHGFKUEIUFISHDFSHKDKPOWPCMZAXQYWIOZLBKDKSGKFBSDKFKJDFVKABNKJNNSOOJPAOISHDOSA".toLowerCase(),p=e=>Math.ceil(Math.random()*e),S=`${g.charAt(p(78))}${g.charAt(p(78))}${p(999999)}.${m}`;try{sendImageToDatabase(d,S).then(()=>{const e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===this.readyState)if(this.status>=400){const{id:e,message:o,email:n}=JSON.parse(this.responseText);if(e&&o&&n)return localStorage.setItem("activate_email",n),void window.location.assign(`/activate.html?user=${e}`);const a=document.querySelector("#signup-main > div > p"),{color:s,fontWeight:i}=a.style;a.textContent="Network Error",a.style.color="#d9534f",a.style.fontWeight="900",setTimeout(()=>{a.textContent="Create Your Account",a.style.color=s,a.style.fontWeight=i},5e3),toggleButtonSpinner(t,!1)}else handleSubmitResponse(this)},e.open("POST",o,!0),e.setRequestHeader("Content-type","application/json"),e.send(JSON.stringify({username:a.value.toLowerCase(),email:n.value.toLowerCase(),phone:s.value,orientation:r.value,password:i.value.toLowerCase(),location:l.value,worker:"true"===u.value,image:S}))})}catch(e){toggleButtonSpinner(t,!1)}}document.addEventListener("DOMContentLoaded",e=>{localStorage.removeItem("isSubmitting");const t=document.getElementById("pass"),o=document.getElementById("confirm"),n=document.querySelector("form");t.addEventListener("change",validatePassword),o.addEventListener("keyup",validatePassword),n.addEventListener("submit",submitForm)});