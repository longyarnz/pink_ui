function validatePassword(){const e=document.getElementById("pass"),t=document.getElementById("confirm");e.value!==t.value?t.setCustomValidity("Passwords Don't Match"):t.setCustomValidity("")}function handleSubmitResponse(e){const{id:t,message:n,token:o}=JSON.parse(e.responseText);t||n?window.location.assign(`/activate.html?user=${t}`):o&&(localStorage.pinkettu=o,window.location.assign("/profile.html"))}function submitForm(e){if(e.preventDefault(),"true"===localStorage.isSubmitting)return;const t=e.target.children.finalSubmit;toggleButtonSpinner(t,!0);const n=`${API}/auth/signup`,{email:o,username:a,phone:s,password:i,orientation:r,location:l,worker:u,image:m}=e.target.elements,c=m.files[0],d=c.name.split(".").pop(),g="JKHIHGFKUEIUFISHDFSHKDKPOWPCMZAXQYWIOZLBKDKSGKFBSDKFKJDFVKABNKJNNSOOJPAOISHDOSA".toLowerCase(),p=e=>Math.ceil(Math.random()*e),h=`${g.charAt(p(78))}${g.charAt(p(78))}${p(999999)}.${d}`;try{sendImageToDatabase(c,h).then(()=>{const e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===this.readyState)if(this.status>=400){const{id:e,message:n,email:o}=JSON.parse(this.responseText);if(e&&n&&o)return localStorage.setItem("activate_email",o),void window.location.assign(`/activate.html?user=${e}`);const a=document.querySelector("#signup-main > div > p"),{color:s,fontWeight:i}=a.style;a.textContent="Network Error",a.style.color="#d9534f",a.style.fontWeight="900",setTimeout(()=>{a.textContent="Create Your Account",a.style.color=s,a.style.fontWeight=i},5e3),toggleButtonSpinner(t,!1)}else handleSubmitResponse(this)},e.open("POST",n,!0),e.setRequestHeader("Content-type","application/json"),e.send(JSON.stringify({username:a.value.toLowerCase(),email:o.value.toLowerCase(),phone:s.value,orientation:r.value,password:i.value.toLowerCase(),location:l.value,worker:"true"===u.value,image:h}))})}catch(e){toggleButtonSpinner(t,!1)}}document.addEventListener("DOMContentLoaded",e=>{localStorage.removeItem("isSubmitting");const t=document.getElementById("pass"),n=document.getElementById("confirm"),o=document.getElementsByTagName("form")[0];t.addEventListener("change",validatePassword),n.addEventListener("keyup",validatePassword),o.addEventListener("submit",submitForm)});