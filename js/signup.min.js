function validatePassword(){const e=document.getElementById("pass"),t=document.getElementById("confirm");e.value!==t.value?t.setCustomValidity("Passwords Don't Match"):t.setCustomValidity("")}function handleSubmitResponse(e){const{id:t,message:n,token:o}=JSON.parse(e.responseText);t||n?window.location.assign(`/activate.html?user=${t}`):o&&(localStorage.pinkettu=o,window.location.assign("/profile.html"))}function submitForm(e){if(e.preventDefault(),"true"===localStorage.isSubmitting)return;const t=e.target.children.finalSubmit;toggleButtonSpinner(t,!0);const n=`${API}/auth/signup`,[o,s,a,i,,r,l,u]=e.target,d=Math.floor(100*Math.random()),c=u.files[0].name.replace(/\s/i,".");caption=`${d}.${c}`;try{sendImageToDatabase(u,caption).then(()=>{const e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===this.readyState)if(this.status>=400){alert(this.responseText);const{id:e,message:n}=JSON.parse(this.responseText);if(e&&n)return void window.location.assign(`/activate.html?user=${e}`);const o=document.querySelector("#signup-main > div > p"),{color:s,fontWeight:a}=o.style;o.textContent="Network Error",o.style.color="#d9534f",o.style.fontWeight="900",setTimeout(()=>{o.textContent="Create Your Account",o.style.color=s,o.style.fontWeight=a},5e3),toggleButtonSpinner(t,!1)}else handleSubmitResponse(this)},e.open("POST",n,!0),e.setRequestHeader("Content-type","application/json"),e.send(JSON.stringify({username:s.value.toLowerCase(),email:o.value.toLowerCase(),phone:a.value,password:i.value.toLowerCase(),location:r.value,worker:"true"===l.value,image:caption}))})}catch(e){toggleButtonSpinner(t,!1)}}document.addEventListener("DOMContentLoaded",e=>{localStorage.removeItem("isSubmitting");const t=document.getElementById("pass"),n=document.getElementById("confirm"),o=document.getElementsByTagName("form")[0];t.addEventListener("change",validatePassword),n.addEventListener("keyup",validatePassword),o.addEventListener("submit",submitForm)});