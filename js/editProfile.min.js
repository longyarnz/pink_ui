function handleSubmitResponse(e,t){const{message:n}=JSON.parse(e.responseText);if("Invalid User"===n)return localStorage.removeItem("pinkettu"),window.location.assign("/login.html"),void toggleButtonSpinner(t,!1);toggleButtonSpinner(t,!1),window.location.assign("/profile.html")}function submitForm(e,t){function n(e,t){const n=e.name.split(".").pop(),o="JKHIHGFKUEIUFISHDFSHKDKPOWPCMZAXQYWIOZLBKDKSGKFBSDKFKJDFVKABNKJNNSOOJPAOISHDOSA".toLowerCase(),i=e=>Math.ceil(Math.random()*e),s=`${o.charAt(i(78))}${o.charAt(i(78))}${i(999999)}.${n}`;t.push(s),a=sendImageToDatabase(e,s),r.push(a)}if(e.preventDefault(),"true"===localStorage.isSubmitting)return;const o=e.target.children.finalSubmit;toggleButtonSpinner(o,!0);const i=`${API}/profile`;let a,s,r=[];const{username:l,phone:u,hour:g,night:p,week:c,orientation:h,location:m,image:f,more:S}=e.target.elements,d=g&&p&&c?[parseInt(g.value),parseInt(p.value),parseInt(c.value)]:[];if(s={username:l.value,phone:u.value,location:m.value,orientation:h.value,rates:d,image:[],more:[]},f.files.length>0&&n(f.files[0],s.image),t&&S.files.length>0)for(let e=0;e<S.files.length;e++){n(S.files[e],s.more)}Promise.all(r).then(()=>{const e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===this.readyState)if(this.status>=400){const e=o.children[0];e.textContent="Network Error",o.style.backgroundColor="#d9534f",toggleButtonSpinner(o,!1),setTimeout(()=>{e.textContent="Edit Profile",o.style.backgroundColor="#f69"},5e3)}else handleSubmitResponse(this,o)},e.open("PUT",i,!0),e.setRequestHeader("Content-Type","application/json"),e.setRequestHeader("Authorization",localStorage.pinkettu),e.send(JSON.stringify(s))})}